=======================================================================================================================================================================================================================
Layer (type (var_name))                  Input Shape               Output Shape              Param #                   Param %                   Kernel Shape              Mult-Adds                 Trainable
=======================================================================================================================================================================================================================
Model (Model)                            [128, 3, 64, 64]          [128, 42]                 --                             --                   --                        --                        True
├─Sequential (conv1)                     [128, 3, 64, 64]          [128, 64, 64, 64]         --                             --                   --                        --                        True
│    └─Conv2d (0)                        [128, 3, 64, 64]          [128, 64, 64, 64]         1,792                       0.02%                   [3, 3]                    939,524,096               True
│    └─BatchNorm2d (1)                   [128, 64, 64, 64]         [128, 64, 64, 64]         128                         0.00%                   --                        16,384                    True
│    └─ReLU (2)                          [128, 64, 64, 64]         [128, 64, 64, 64]         --                             --                   --                        --                        --
├─Sequential (conv2)                     [128, 64, 64, 64]         [128, 128, 32, 32]        --                             --                   --                        --                        True
│    └─Conv2d (0)                        [128, 64, 64, 64]         [128, 128, 64, 64]        73,856                      0.81%                   [3, 3]                    38,721,814,528            True
│    └─BatchNorm2d (1)                   [128, 128, 64, 64]        [128, 128, 64, 64]        256                         0.00%                   --                        32,768                    True
│    └─ReLU (2)                          [128, 128, 64, 64]        [128, 128, 64, 64]        --                             --                   --                        --                        --
│    └─MaxPool2d (3)                     [128, 128, 64, 64]        [128, 128, 32, 32]        --                             --                   2                         --                        --
├─Sequential (shuffle1_v2)               [128, 128, 32, 32]        [128, 128, 32, 32]        --                             --                   --                        --                        True
│    └─Conv2d (0)                        [128, 128, 32, 32]        [128, 512, 32, 32]        66,048                      0.72%                   [1, 1]                    8,657,043,456             True
│    └─BatchNorm2d (1)                   [128, 512, 32, 32]        [128, 512, 32, 32]        1,024                       0.01%                   --                        131,072                   True
│    └─Conv2d (2)                        [128, 512, 32, 32]        [128, 512, 32, 32]        5,120                       0.06%                   [3, 3]                    671,088,640               True
│    └─BatchNorm2d (3)                   [128, 512, 32, 32]        [128, 512, 32, 32]        1,024                       0.01%                   --                        131,072                   True
│    └─Conv2d (4)                        [128, 512, 32, 32]        [128, 128, 32, 32]        65,664                      0.72%                   [1, 1]                    8,606,711,808             True
│    └─BatchNorm2d (5)                   [128, 128, 32, 32]        [128, 128, 32, 32]        256                         0.00%                   --                        32,768                    True
│    └─ReLU (6)                          [128, 128, 32, 32]        [128, 128, 32, 32]        --                             --                   --                        --                        --
├─Sequential (conv3)                     [128, 128, 32, 32]        [128, 256, 16, 16]        --                             --                   --                        --                        True
│    └─Conv2d (0)                        [128, 128, 32, 32]        [128, 256, 32, 32]        295,168                     3.23%                   [3, 3]                    38,688,260,096            True
│    └─BatchNorm2d (1)                   [128, 256, 32, 32]        [128, 256, 32, 32]        512                         0.01%                   --                        65,536                    True
│    └─ReLU (2)                          [128, 256, 32, 32]        [128, 256, 32, 32]        --                             --                   --                        --                        --
│    └─MaxPool2d (3)                     [128, 256, 32, 32]        [128, 256, 16, 16]        --                             --                   2                         --                        --
├─Sequential (conv4)                     [128, 256, 16, 16]        [128, 512, 8, 8]          --                             --                   --                        --                        True
│    └─Conv2d (0)                        [128, 256, 16, 16]        [128, 512, 16, 16]        1,180,160                  12.91%                   [3, 3]                    38,671,482,880            True
│    └─BatchNorm2d (1)                   [128, 512, 16, 16]        [128, 512, 16, 16]        1,024                       0.01%                   --                        131,072                   True
│    └─ReLU (2)                          [128, 512, 16, 16]        [128, 512, 16, 16]        --                             --                   --                        --                        --
│    └─MaxPool2d (3)                     [128, 512, 16, 16]        [128, 512, 8, 8]          --                             --                   2                         --                        --
├─Sequential (shuffle2_v2)               [128, 512, 8, 8]          [128, 512, 8, 8]          --                             --                   --                        --                        True
│    └─Conv2d (0)                        [128, 512, 8, 8]          [128, 2048, 8, 8]         1,050,624                  11.50%                   [1, 1]                    8,606,711,808             True
│    └─BatchNorm2d (1)                   [128, 2048, 8, 8]         [128, 2048, 8, 8]         4,096                       0.04%                   --                        524,288                   True
│    └─Conv2d (2)                        [128, 2048, 8, 8]         [128, 2048, 8, 8]         20,480                      0.22%                   [3, 3]                    167,772,160               True
│    └─BatchNorm2d (3)                   [128, 2048, 8, 8]         [128, 2048, 8, 8]         4,096                       0.04%                   --                        524,288                   True
│    └─Conv2d (4)                        [128, 2048, 8, 8]         [128, 512, 8, 8]          1,049,088                  11.48%                   [1, 1]                    8,594,128,896             True
│    └─BatchNorm2d (5)                   [128, 512, 8, 8]          [128, 512, 8, 8]          1,024                       0.01%                   --                        131,072                   True
│    └─ReLU (6)                          [128, 512, 8, 8]          [128, 512, 8, 8]          --                             --                   --                        --                        --
├─Sequential (conv5)                     [128, 512, 8, 8]          [128, 1024, 4, 4]         --                             --                   --                        --                        True
│    └─Conv2d (0)                        [128, 512, 8, 8]          [128, 1024, 8, 8]         4,719,616                  51.64%                   [3, 3]                    38,663,094,272            True
│    └─BatchNorm2d (1)                   [128, 1024, 8, 8]         [128, 1024, 8, 8]         2,048                       0.02%                   --                        262,144                   True
│    └─ReLU (2)                          [128, 1024, 8, 8]         [128, 1024, 8, 8]         --                             --                   --                        --                        --
│    └─MaxPool2d (3)                     [128, 1024, 8, 8]         [128, 1024, 4, 4]         --                             --                   2                         --                        --
├─Sequential (res)                       [128, 1024, 4, 4]         [128, 42]                 --                             --                   --                        --                        True
│    └─MaxPool2d (0)                     [128, 1024, 4, 4]         [128, 1024, 1, 1]         --                             --                   4                         --                        --
│    └─Flatten (1)                       [128, 1024, 1, 1]         [128, 1024]               --                             --                   --                        --                        --
│    └─Dropout (2)                       [128, 1024]               [128, 1024]               --                             --                   --                        --                        --
│    └─Linear (3)                        [128, 1024]               [128, 512]                524,800                     5.74%                   --                        67,174,400                True
│    └─Linear (4)                        [128, 512]                [128, 128]                65,664                      0.72%                   --                        8,404,992                 True
│    └─Linear (5)                        [128, 128]                [128, 42]                 5,418                       0.06%                   --                        693,504                   True
=======================================================================================================================================================================================================================
Total params: 9,138,986
Trainable params: 9,138,986
Non-trainable params: 0
Total mult-adds (G): 191.07
=======================================================================================================================================================================================================================
Input size (MB): 6.29
Forward/backward pass size (MB): 5570.73
Params size (MB): 36.56
Estimated Total Size (MB): 5613.58
=======================================================================================================================================================================================================================
[0] acc/rec/prec: 0.69/0.38/0.37 | train/valid loss: 1.7383/1.1994
[1] acc/rec/prec: 0.83/0.49/0.56 | train/valid loss: 0.7254/0.6174
[2] acc/rec/prec: 0.86/0.59/0.66 | train/valid loss: 0.4817/0.5244
[3] acc/rec/prec: 0.86/0.56/0.73 | train/valid loss: 0.3452/0.5144
Saved weights with acc/rec/prec: 0.86/0.69/0.77| loss: 0.5414
[4] acc/rec/prec: 0.86/0.69/0.77 | train/valid loss: 0.2724/0.5414
Saved weights with acc/rec/prec: 0.89/0.65/0.74| loss: 0.4403
[5] acc/rec/prec: 0.89/0.65/0.74 | train/valid loss: 0.2149/0.4403
[6] acc/rec/prec: 0.85/0.66/0.78 | train/valid loss: 0.1465/0.6098
Saved weights with acc/rec/prec: 0.90/0.72/0.82| loss: 0.4238
[7] acc/rec/prec: 0.90/0.72/0.82 | train/valid loss: 0.1259/0.4238
[8] acc/rec/prec: 0.87/0.68/0.82 | train/valid loss: 0.0938/0.6075
Saved weights with acc/rec/prec: 0.92/0.75/0.85| loss: 0.3946
[9] acc/rec/prec: 0.92/0.75/0.85 | train/valid loss: 0.0756/0.3946
[10] acc/rec/prec: 0.91/0.77/0.80 | train/valid loss: 0.0646/0.4046
[11] acc/rec/prec: 0.90/0.70/0.82 | train/valid loss: 0.0543/0.5008
Saved weights with acc/rec/prec: 0.93/0.78/0.84| loss: 0.3504
[12] acc/rec/prec: 0.93/0.78/0.84 | train/valid loss: 0.0420/0.3504
[13] acc/rec/prec: 0.91/0.76/0.82 | train/valid loss: 0.0490/0.4360
[14] acc/rec/prec: 0.91/0.79/0.84 | train/valid loss: 0.0483/0.4559
Saved weights with acc/rec/prec: 0.94/0.82/0.88| loss: 0.3272
[15] acc/rec/prec: 0.94/0.82/0.88 | train/valid loss: 0.0419/0.3272
[16] acc/rec/prec: 0.94/0.82/0.84 | train/valid loss: 0.0288/0.3333
[17] acc/rec/prec: 0.93/0.83/0.88 | train/valid loss: 0.0181/0.3838
[18] acc/rec/prec: 0.94/0.82/0.85 | train/valid loss: 0.0226/0.3305
[19] acc/rec/prec: 0.93/0.87/0.84 | train/valid loss: 0.0189/0.3853
[20] acc/rec/prec: 0.94/0.85/0.91 | train/valid loss: 0.0159/0.3716
[21] acc/rec/prec: 0.93/0.83/0.88 | train/valid loss: 0.0136/0.3846
[22] acc/rec/prec: 0.93/0.89/0.90 | train/valid loss: 0.0157/0.4097
[23] acc/rec/prec: 0.94/0.87/0.88 | train/valid loss: 0.0139/0.3455
Saved weights with acc/rec/prec: 0.95/0.91/0.92| loss: 0.3146
[24] acc/rec/prec: 0.95/0.91/0.92 | train/valid loss: 0.0051/0.3146
