=======================================================================================================================================================================================================================
Layer (type (var_name))                  Input Shape               Output Shape              Param #                   Param %                   Kernel Shape              Mult-Adds                 Trainable
=======================================================================================================================================================================================================================
Model (Model)                            [128, 3, 64, 64]          [128, 42]                 --                             --                   --                        --                        True
├─Sequential (conv1)                     [128, 3, 64, 64]          [128, 64, 64, 64]         --                             --                   --                        --                        True
│    └─myConvBlock (0)                   [128, 3, 64, 64]          [128, 64, 64, 64]         1,920                       0.02%                   [3, 3]                    939,540,480               True
├─Sequential (conv2)                     [128, 64, 64, 64]         [128, 128, 32, 32]        --                             --                   --                        --                        True
│    └─myConvBlock (0)                   [128, 64, 64, 64]         [128, 128, 64, 64]        74,112                      0.81%                   [3, 3]                    38,721,847,296            True
│    └─MaxPool2d (1)                     [128, 128, 64, 64]        [128, 128, 32, 32]        --                             --                   2                         --                        --
├─Sequential (residualBlock_1)           [128, 128, 32, 32]        [128, 128, 32, 32]        --                             --                   --                        --                        True
│    └─myConvBlock (0)                   [128, 128, 32, 32]        [128, 512, 32, 32]        67,072                      0.73%                   [1, 1]                    8,657,174,528             True
│    └─myConvBlock (1)                   [128, 512, 32, 32]        [128, 512, 32, 32]        6,144                       0.07%                   [3, 3]                    671,219,712               True
│    └─myConvBlock (2)                   [128, 512, 32, 32]        [128, 128, 32, 32]        65,920                      0.72%                   [1, 1]                    8,606,744,576             True
├─Sequential (conv3)                     [128, 128, 32, 32]        [128, 256, 16, 16]        --                             --                   --                        --                        True
│    └─myConvBlock (0)                   [128, 128, 32, 32]        [128, 256, 32, 32]        295,680                     3.24%                   [3, 3]                    38,688,325,632            True
│    └─MaxPool2d (1)                     [128, 256, 32, 32]        [128, 256, 16, 16]        --                             --                   2                         --                        --
├─Sequential (conv4)                     [128, 256, 16, 16]        [128, 512, 8, 8]          --                             --                   --                        --                        True
│    └─myConvBlock (0)                   [128, 256, 16, 16]        [128, 512, 16, 16]        1,181,184                  12.92%                   [3, 3]                    38,671,613,952            True
│    └─MaxPool2d (1)                     [128, 512, 16, 16]        [128, 512, 8, 8]          --                             --                   2                         --                        --
├─Sequential (residualBlock_2)           [128, 512, 8, 8]          [128, 512, 8, 8]          --                             --                   --                        --                        True
│    └─myConvBlock (0)                   [128, 512, 8, 8]          [128, 2048, 8, 8]         1,054,720                  11.54%                   [1, 1]                    8,607,236,096             True
│    └─myConvBlock (1)                   [128, 2048, 8, 8]         [128, 2048, 8, 8]         24,576                      0.27%                   [3, 3]                    168,296,448               True
│    └─myConvBlock (2)                   [128, 2048, 8, 8]         [128, 512, 8, 8]          1,050,112                  11.49%                   [1, 1]                    8,594,259,968             True
├─Sequential (conv5)                     [128, 512, 8, 8]          [128, 1024, 4, 4]         --                             --                   --                        --                        True
│    └─myConvBlock (0)                   [128, 512, 8, 8]          [128, 1024, 8, 8]         4,721,664                  51.67%                   [3, 3]                    38,663,356,416            True
│    └─MaxPool2d (1)                     [128, 1024, 8, 8]         [128, 1024, 4, 4]         --                             --                   2                         --                        --
├─Sequential (res)                       [128, 1024, 4, 4]         [128, 42]                 --                             --                   --                        --                        True
│    └─MaxPool2d (0)                     [128, 1024, 4, 4]         [128, 1024, 1, 1]         --                             --                   4                         --                        --
│    └─Flatten (1)                       [128, 1024, 1, 1]         [128, 1024]               --                             --                   --                        --                        --
│    └─Dropout (2)                       [128, 1024]               [128, 1024]               --                             --                   --                        --                        --
│    └─Linear (3)                        [128, 1024]               [128, 512]                524,800                     5.74%                   --                        67,174,400                True
│    └─Linear (4)                        [128, 512]                [128, 128]                65,664                      0.72%                   --                        8,404,992                 True
│    └─Linear (5)                        [128, 128]                [128, 42]                 5,418                       0.06%                   --                        693,504                   True
=======================================================================================================================================================================================================================
Total params: 9,138,986
Trainable params: 9,138,986
Non-trainable params: 0
Total mult-adds (G): 191.07
=======================================================================================================================================================================================================================
Input size (MB): 6.29
Forward/backward pass size (MB): 5570.73
Params size (MB): 36.56
Estimated Total Size (MB): 5613.58
=======================================================================================================================================================================================================================
[0] acc/rec/prec: 0.66/0.34/0.39 | train/valid loss: 1.7814/1.2151
[1] acc/rec/prec: 0.82/0.47/0.55 | train/valid loss: 0.7027/0.6747
[2] acc/rec/prec: 0.83/0.57/0.61 | train/valid loss: 0.4755/0.6948
[3] acc/rec/prec: 0.83/0.60/0.73 | train/valid loss: 0.3359/0.6274
Saved weights with acc/rec/prec: 0.89/0.69/0.78| loss: 0.4554
[4] acc/rec/prec: 0.89/0.69/0.78 | train/valid loss: 0.2532/0.4554
[5] acc/rec/prec: 0.85/0.68/0.74 | train/valid loss: 0.1840/0.6142
[6] acc/rec/prec: 0.87/0.62/0.72 | train/valid loss: 0.1588/0.5630
Saved weights with acc/rec/prec: 0.90/0.68/0.82| loss: 0.3944
[7] acc/rec/prec: 0.90/0.68/0.82 | train/valid loss: 0.1043/0.3944
[8] acc/rec/prec: 0.87/0.73/0.79 | train/valid loss: 0.0821/0.5894
Saved weights with acc/rec/prec: 0.92/0.77/0.82| loss: 0.3712
[9] acc/rec/prec: 0.92/0.77/0.82 | train/valid loss: 0.0833/0.3712
Saved weights with acc/rec/prec: 0.92/0.82/0.85| loss: 0.3454
[10] acc/rec/prec: 0.92/0.82/0.85 | train/valid loss: 0.0573/0.3454
[11] acc/rec/prec: 0.91/0.78/0.84 | train/valid loss: 0.0628/0.4276
[12] acc/rec/prec: 0.90/0.84/0.83 | train/valid loss: 0.0377/0.4622
[13] acc/rec/prec: 0.92/0.74/0.84 | train/valid loss: 0.0320/0.3945
[14] acc/rec/prec: 0.91/0.78/0.84 | train/valid loss: 0.0427/0.4887
Saved weights with acc/rec/prec: 0.95/0.86/0.87| loss: 0.2707
[15] acc/rec/prec: 0.95/0.86/0.87 | train/valid loss: 0.0166/0.2707
Saved weights with acc/rec/prec: 0.95/0.88/0.90| loss: 0.2579
[16] acc/rec/prec: 0.95/0.88/0.90 | train/valid loss: 0.0090/0.2579
Saved weights with acc/rec/prec: 0.95/0.86/0.88| loss: 0.2575
[17] acc/rec/prec: 0.95/0.86/0.88 | train/valid loss: 0.0059/0.2575
Saved weights with acc/rec/prec: 0.95/0.88/0.91| loss: 0.2558
[18] acc/rec/prec: 0.95/0.88/0.91 | train/valid loss: 0.0051/0.2558
[19] acc/rec/prec: 0.95/0.87/0.88 | train/valid loss: 0.0046/0.2578
Saved weights with acc/rec/prec: 0.95/0.86/0.86| loss: 0.2539
[20] acc/rec/prec: 0.95/0.86/0.86 | train/valid loss: 0.0044/0.2539
[21] acc/rec/prec: 0.95/0.89/0.90 | train/valid loss: 0.0034/0.2540
Saved weights with acc/rec/prec: 0.95/0.88/0.88| loss: 0.2531
[22] acc/rec/prec: 0.95/0.88/0.88 | train/valid loss: 0.0030/0.2531
Saved weights with acc/rec/prec: 0.95/0.86/0.90| loss: 0.2457
[23] acc/rec/prec: 0.95/0.86/0.90 | train/valid loss: 0.0026/0.2457
[24] acc/rec/prec: 0.95/0.88/0.92 | train/valid loss: 0.0028/0.2585


Test:
accuracy: 99.9519%
recall: 98.9814%
precision: 99.1894%
F: 99.0853%
